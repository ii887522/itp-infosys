-- Insert test data
INSERT INTO company VALUES(
	"CMY Enterprise",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
    50,
    "Axiata Tower, Level 20, 9, Jalan Stesen Sentral 5, Kuala Lumpur Sentral, 50470 Kuala Lumpur, Federal Territory of Kuala Lumpur",
  "https://www.tarc.edu.my/"
);

INSERT INTO internship VALUES
(
	"Software Engineer",
	"CMY Enterprise",
	500,
	1200,
	"Cheras",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
  3
),
(
	"Analyst Programmer",
	"CMY Enterprise",
	400,
	NULL,
	"Cheras",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
  3
),
(
	"Frontend Developer",
	"CMY Enterprise",
	NULL,
	NULL,
	"Cheras",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
  5
),
(
	"AI Engineer",
	"CMY Enterprise",
	200,
	1000,
	"Petaling Jaya",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
  1
),
(
	"Backend Developer",
	"CMY Enterprise",
	200,
	800,
	"Kajang",
	"Lorem <b>ipsum</b> dolor sit amet, consectetur adipiscing elit. Proin ac leo vel neque finibus tincidunt in id odio. Aenean ut lacus mauris. Morbi sed elit eu erat lacinia facilisis. Cras suscipit, tortor posuere congue gravida, enim lorem consequat quam, non imperdiet sapien ex eu purus. Pellentesque vitae dui non risus rhoncus pretium. Sed ultricies dolor non rutrum dapibus. In id libero in purus blandit tincidunt vel nec enim. Curabitur accumsan lacus risus, eu dapibus lorem efficitur ornare. Vestibulum quis lorem a magna pulvinar ultrices. Nullam elementum facilisis ligula, et placerat odio congue a. Vivamus tempor sagittis dui, pharetra laoreet risus fermentum non.

    <div><br><div>In neque ex, pellentesque vitae magna at, efficitur vulputate nunc. Phasellus nibh nulla, rutrum sed velit non, tristique tempus lacus. Quisque tristique euismod orci, faucibus aliquet magna vestibulum vulputate. Praesent vehicula sodales est sit amet bibendum. Ut dictum bibendum hendrerit. Suspendisse sit amet nisl quis tellus placerat fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Suspendisse interdum dapibus diam non lacinia. Proin a luctus ex. Curabitur mollis mollis consequat.

    <div><br><div>Morbi ac quam odio. Vivamus vel tincidunt sapien, ut aliquam velit. Cras eget sem ac justo tristique tempus a at risus. Phasellus faucibus, sapien ut mattis mattis, dui nunc aliquam leo, sed consectetur dolor quam quis justo. Morbi ut massa elit. Nunc venenatis fermentum lobortis. Nunc accumsan orci magna. Donec ante sapien, ornare a orci vitae, condimentum faucibus dolor.</div></div>",
  4
);

INSERT INTO category VALUES
	("Backend", "Software Engineer", "CMY Enterprise"),
	("Frontend", "Software Engineer", "CMY Enterprise"),
	("Full Stack", "Software Engineer", "CMY Enterprise"),
	("Backend", "Analyst Programmer", "CMY Enterprise"),
	("Frontend", "Analyst Programmer", "CMY Enterprise"),
	("Full Stack", "Analyst Programmer", "CMY Enterprise"),
	("Frontend", "Frontend Developer", "CMY Enterprise"),
	("Artifical Intelligence", "AI Engineer", "CMY Enterprise"),
	("Data Science", "AI Engineer", "CMY Enterprise"),
	("Backend", "Backend Developer", "CMY Enterprise");
	
INSERT INTO learning_outcome VALUES
	("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Software Engineer", "CMY Enterprise"),
	("Quisque fermentum metus sed nibh pharetra, ac semper arcu tincidunt.", "Software Engineer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elits.", "Software Engineer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Analyst Programmer", "CMY Enterprise"),
	("Quisque fermentum metus sed nibh pharetra, ac semper arcu tincidunt.", "Analyst Programmer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Frontend Developer", "CMY Enterprise"),
	("Quisque fermentum metus sed nibh pharetra, ac semper arcu tincidunt.", "AI Engineer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elits.", "AI Engineer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elit.", "Backend Developer", "CMY Enterprise"),
	("Quisque fermentum metus sed nibh pharetra, ac semper arcu tincidunt.", "Backend Developer", "CMY Enterprise"),
	("Lorem ipsum dolor sit amet, consectetur adipiscing elits.", "Backend Developer", "CMY Enterprise");

-- Fetch a page of internships from the database
SELECT
  internship.title,
  internship.company_name,
  JSON_ARRAYAGG(DISTINCT category.`value`) categories,
  min_allowance,
  max_allowance,
  `location`,
  JSON_ARRAYAGG(DISTINCT learning_outcome.`value`) learning_outcomes,
  internship.`description`,
  company.`description` company_description,
  company.size company_size,
  company.address,
  company.url company_url,
  vacancy_count
FROM internship
  LEFT JOIN category
    ON internship.title = category.itp_title AND internship.company_name = category.company_name
  LEFT JOIN learning_outcome
    ON internship.title = learning_outcome.itp_title AND internship.company_name = learning_outcome.company_name
  INNER JOIN company
    ON internship.company_name = company.`name`
WHERE internship.title > "" OR internship.title = "" AND internship.company_name > ""
GROUP BY internship.title, internship.company_name
ORDER BY internship.title, internship.company_name
LIMIT 1000;
